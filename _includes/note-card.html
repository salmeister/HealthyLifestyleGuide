{%- comment -%}
Reusable Note Card
Usage:
{% include note-card.html url="/notes/diet/The-Miracle-of-Fasting" show="Know Thyself" title="Dr. Mindy Pelz – The Miracle of Fasting" tags="Nutrition,Brain" platform="youtube" %}
Parameters:
- url: internal notes URL
- show: source show/podcast name
- title: descriptive episode or resource title
- tags: comma list
- platform: youtube|spotify|apple|amazon|generic (for icon accent)
{%- endcomment -%}
{%- assign tag_list = include.tags | default: '' | split: ',' -%}
{%- comment -%} Try to find the note by matching url path (strip leading slash) {%- endcomment -%}
{%- assign target_path = include.url | remove: site.baseurl | replace: '//','/' -%}
{%- assign note_match = site.notes | where: 'url', target_path | first -%}
{%- assign display_date = include.date | default: note_match.date -%}
<a class="note-card platform-{{ include.platform | default: 'generic' }}" href="{{ include.url }}">
  <div class="note-card-body">
    <div class="note-card-top">
      <span class="note-card-show">{{ include.show }}</span>
      {%- if display_date -%}
      <time class="note-card-date" datetime="{{ display_date | date_to_xmlschema }}">{{ display_date | date: '%Y-%m-%d' }}</time>
      {%- endif -%}
    </div>
    {%- comment -%}
      Title splitting logic: expect patterns like "Guest – Episode Title" or "Guest - Episode Title".
      If no delimiter present, render entire title as episode line only.
    {%- endcomment -%}
    {%- assign raw_title = include.title | strip -%}
    {%- if raw_title contains ' – ' -%}
      {%- assign parts = raw_title | split: ' – ' -%}
    {%- elsif raw_title contains ' - ' -%}
      {%- assign parts = raw_title | split: ' - ' -%}
    {%- else -%}
      {%- assign parts = raw_title | split: '||' -%} {# produces single-element array #}
    {%- endif -%}
    {%- assign guest_name = parts[0] | strip -%}
    {%- assign episode_title = parts[1] | default: '' | strip -%}
    <div class="note-card-title-block">
      {%- if episode_title != '' -%}
        <div class="note-card-guest">{{ guest_name }}</div>
  <h3 class="note-card-title"><span class="note-card-episode">{{ episode_title }}</span></h3>
      {%- else -%}
        <h3 class="note-card-title"><span class="note-card-episode">{{ guest_name }}</span></h3>
      {%- endif -%}
    </div>
    <div class="note-card-tags">
      {%- for t in tag_list -%}
        {%- assign clean = t | strip -%}
        {%- if clean != '' -%}
          <span class="badge badge-{{ clean | downcase | replace: ' ', '-' }}">{{ clean }}</span>
        {%- endif -%}
      {%- endfor -%}
    </div>
  </div>
</a>
